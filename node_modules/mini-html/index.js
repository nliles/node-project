/**
 * miniHTML(html, file, overwrite);
 * @param html a block of HTML
 * @param file a file path and name
 * @param overwrite save over old version
 */
module.exports = (function() {
    var fs = require("fs");
    
    return function(htmlfile, contents, overwrite) {
        var html = contents || fileContents(htmlfile);    
        var stripchars = ["\\n", "\\t", "\\r", "\n", "\r", "\t", "  ", ];
        for(var i=0, len=stripchars.length; i<len; i++) {
            var char = stripchars[i];
            while(html.indexOf(char) > -1) {
                html = html.split(char).join(" ");
            }
        }
        if(html.indexOf("> <") > -1) {
            html = html.split("> <").join("><");
        }
    	if(overwrite) {
    		if(fs.existsSync(htmlfile)) {
    			fs.unlinkSync(htmlfile);
    		}
    		fs.writeFileSync(htmlfile, html);
    	}
        return html;
    };
    	
    function fileContents(filename) {
        if(!fs.existsSync(filename)) {
            return "";
        }
        return fs.readFileSync(filename, { "encoding": "utf8" }).toString("utf8");
    }
})();